[
  {
    "type": "lesson_learned",
    "title": "PDF交易账单解析的技术挑战",
    "content": "Tiger Brokers PDF账单格式极其复杂：表格被打散成10,851行单行文本，每个单元格是独立一行，数据按列而非按行排列。解决方案：1)使用pdfminer.six提取文本 2)定位关键字段位置(代码/市场/交易类型) 3)窗口滑动法识别模式(US+COMEX+开仓/平仓) 4)数据验证(价格74-80美元，数量1-50手)。最终成功从碎片中提取70条完整SIL交易记录，包含价格/数量/损益全部信息。",
    "tags": ["PDF解析", "数据提取", "Tiger Brokers", "技术难点", "窗口滑动法"],
    "project": "tigertrade",
    "date": "2026-01-21",
    "importance": "high"
  },
  {
    "type": "knowledge",
    "title": "用户真实交易表现完整数据",
    "content": "账户683505，2026.01.01-01.19（19天）。期货盈利$50,801.67，收益率71.37%，月化约113%。提取70条SIL交易：开仓22次，平仓48次（比例2.18:1验证多次加仓策略），累计损益$14,621.35，平均每笔$252.09，胜率77.6%，最大盈利$2,568.98，最大亏损$-1,861.02。价格区间74-80美元。识别15个完整交易轮次，多次开仓比例18.2%，平均2.5次/轮，最多3次，加仓间距0.55美元，最大跌幅容忍1.03美元。用户声称月收益$20,000，实际远超（19天$50,801）。",
    "tags": ["真实交易", "SIL", "白银期货", "账户表现", "收益率", "交易轮次"],
    "project": "tigertrade",
    "date": "2026-01-21"
  },
  {
    "type": "rule",
    "title": "用户交易策略核心规则（基于70条真实数据）",
    "content": "1.入场：品种SIL2603/COMEX，价格74-80美元，初始1-2手。2.加仓：触发条件价格下跌0.55美元，次数2-3次最多3次，仓位1-2手/次，容忍最大跌幅1.03美元（实际能容$5000浮亏）。3.持仓：最大2手居多，偶尔1手，峰值可达5手。4.止盈：目标$271/轮，胜率77.6%，盈利$100-700区间，极少数$2500+，不严格遵守固定点位根据盘面判断。5.风控：最大亏损$1,861/轮，平均盈$252，不严格止损。6.频率：19天70笔，日均3.7笔。7.关键特征：通过加仓降低成本、耐心等待价格回升、多数情况盈利出场。",
    "tags": ["交易规则", "SIL策略", "加仓", "风险控制", "止盈", "量化参数"],
    "project": "tigertrade",
    "date": "2026-01-21"
  },
  {
    "type": "lesson_learned",
    "title": "数据管理问题的根本原因与解决方案",
    "content": "问题：回测找不到6970条历史数据。根因：1)路径不统一(采集/training_data，回测/tigertrade/data) 2)无文档记录数据位置 3)多个数据目录并存导致混乱 4)没有版本管理(多个full_20260120_*.csv不知哪个最新)。解决方案：1)统一配置管理(config/paths.py所有脚本使用) 2)数据清单文件(data_manifest.json记录latest/records/created_at) 3)目录标准化(/production/current.csv符号链接) 4)自动化检查(check_data.sh失败时明确提示) 5)README文档。经验教训：明确约定>灵活性，符号链接统一入口，失败时要响亮，自动化>人工记忆，文档=代码。",
    "tags": ["数据管理", "路径管理", "文件组织", "自动化", "最佳实践"],
    "project": "tigertrade",
    "date": "2026-01-21",
    "importance": "high"
  },
  {
    "type": "knowledge",
    "title": "策略回测结果与用户对比分析",
    "content": "使用6970条历史数据回测用户风格策略。结果：初始$100k，最终$93,951.22，亏损$6,048.78(-6.05%)。交易60笔(买30卖30)，完成30轮，胜率76.7%(与用户77.6%基本一致!)，平均每轮-$201.63，最大盈利$1,310.71，最大亏损-$2,269.88。对比用户：收益率+71.37% vs -6.05%(差距-77.42%)，盈利$50,801 vs -$6,049，胜率77.6% vs 76.7%(一致!)，开仓22 vs 30次，平仓48 vs 30次(少37%)。关键发现：胜率保持但亏损=几次大亏损抵消多次小盈利。问题：1)加仓机制失效(平均0次加仓 vs 用户2-3次) 2)止损过激进(最大-$2,269×6次>$2000) 3)止盈过早。改进方向：启用加仓(条件放宽0.8→0.5，容忍1.03→2.5美元)，放宽止损($1,861→$5,000)，优化止盈(目标×1.5)。",
    "tags": ["回测结果", "策略对比", "性能分析", "改进方向"],
    "project": "tigertrade",
    "date": "2026-01-21"
  },
  {
    "type": "decision",
    "title": "算法策略表现不如用户的深层原因",
    "content": "用户19天+71.37%($50,801)，算法回测-6.05%($-6,049)，但胜率一致(77.6% vs 76.7%)。深层原因：1)缺关键信息：秒级tick数据(用户看盘口)/多时间框架(1m/2m/3m/5m/10m)/日K趋势/市场消息/盘感经验。2)决策机制：用户经验+盘感动态判断，算法固定规则。3)风险管理：用户动态调整止损(容忍$5000浮亏)，算法固定止损$1,861。4)加仓逻辑：用户'感觉会涨回来'触发加仓，算法条件过严导致0次加仓。5)状态管理：用户记住当前轮次状态(已加仓几次/成本多少/浮亏多大)，算法无状态。关键洞察：高胜率但亏损=方向对但风控差，核心是学习用户的'容忍浮亏+加仓降本+耐心等待'。解决方向：模仿学习(70条真实交易训练)、规则提取('感觉'量化)、强化学习(P&L奖励)、状态机(5手峰值管理)。",
    "tags": ["算法vs手工", "策略分析", "性能差距", "改进方向", "深层原因"],
    "project": "tigertrade",
    "date": "2026-01-21",
    "importance": "high"
  },
  {
    "type": "reference",
    "title": "2026-01-21完整工作成果清单",
    "content": "1.PDF提取：从10,851行碎片提取70条SIL交易(价格/数量/损益完整)，Excel:SIL白银期货交易分析_完整版.xlsx。2.策略分析：识别15轮次，提取规则(加仓0.55美元/容忍1.03美元跌幅/目标$271/轮)，Excel:SIL交易轮次分析.xlsx。3.策略实现：strategy_user_style.py(模仿加仓降本/容忍浮亏/耐心等待)，backtest_user_style.py(回测系统)。4.回测验证：6970条数据，胜率76.7%(与用户77.6%一致)但亏损-6.05%，原因加仓0次/大亏损6次>$2000。5.数据管理：定位6970条数据，创建/trading_data/production/current.csv符号链接，生成data_manifest.json清单。6.文档：提取的交易策略规则.txt、策略回测分析报告.md、数据管理问题复盘.md、20260121_工作总结.md。关键洞察：PDF为显示非数据提取设计；用户策略核心=风险管理非胜率；高胜率但亏损=方向对风控差。",
    "tags": ["工作总结", "成果清单", "文件列表"],
    "project": "tigertrade",
    "date": "2026-01-21"
  },
  {
    "type": "todo",
    "title": "优化策略参数并重新回测",
    "content": "当前策略胜率76.7%但亏损-6.05%，需要优化。立即执行：1)调整加仓参数(触发条件0.8→0.5，容忍跌幅1.03→2.5美元) 2)放宽止损($1,861→$5,000) 3)优化止盈(目标×1.5，不过早平仓) 4)重新回测验证。短期：1)实现完整仓位状态管理(记录当前轮次/持仓数/成本/浮亏) 2)添加多时间框架(5m/10m/日K判断趋势) 3)确认用户关键决策点细节。长期：1)模仿学习(基于70条真实交易) 2)强化学习(P&L奖励) 3)小规模实盘测试 4)逐步接近71%收益率。",
    "tags": ["策略优化", "参数调整", "回测", "待办"],
    "project": "tigertrade",
    "priority": "high",
    "status": "pending",
    "assignee": "AI Agent",
    "due_date": "2026-01-22"
  },
  {
    "type": "todo",
    "title": "修复RAG服务并导入所有总结",
    "content": "RAG服务启动失败，ModuleNotFoundError: No module named 'models'。需要：1)修复app/main.py的import路径(from models → from app.models) 2)重启RAG服务验证 3)导入RAG待导入记录.json中的所有总结(8条记录) 4)测试检索功能确保记忆不丢失。重要性：RAG是团队记忆系统，防止重复劳动和信息遗忘的关键。",
    "tags": ["RAG修复", "服务启动", "数据导入", "待办"],
    "project": "tigertrade",
    "priority": "high",
    "status": "pending",
    "assignee": "AI Agent"
  }
]
