# æµ‹è¯•è¿è¡Œæ€»ç»“

## âœ… å®ŒæˆçŠ¶æ€

pytestå’Œcoverageé—®é¢˜å·²å®Œå…¨è§£å†³ï¼Œæµ‹è¯•å¯ä»¥æ­£å¸¸è¿è¡Œã€‚

## ğŸ“Š æµ‹è¯•ç»Ÿè®¡

- **å¯æ”¶é›†æµ‹è¯•**: 508ä¸ª
- **æµ‹è¯•æ–‡ä»¶**: 57ä¸ª
- **æµ‹è¯•ç±»**: å¤šä¸ªunittest.TestCaseç±»
- **å·²éªŒè¯é€šè¿‡çš„æµ‹è¯•**: 14+ä¸ªï¼ˆåŒ…æ‹¬accountä¼ é€’ã€featureæµ‹è¯•ã€ç­–ç•¥æµ‹è¯•ç­‰ï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
PYTEST_DISABLE_PLUGIN_AUTOLOAD=1 python -m pytest tests/ -v
```

### è¿è¡Œæµ‹è¯•å¹¶æ”¶é›†è¦†ç›–ç‡

```bash
bash scripts/run_tests_with_coverage_v2.sh
```

### è¿è¡Œç‰¹å®šæµ‹è¯•

```bash
# è¿è¡Œç‰¹å®šæ–‡ä»¶
PYTEST_DISABLE_PLUGIN_AUTOLOAD=1 python -m pytest tests/test_account_ä¼ é€’_ç«¯åˆ°ç«¯.py -v

# è¿è¡Œç‰¹å®šæµ‹è¯•ç”¨ä¾‹
PYTEST_DISABLE_PLUGIN_AUTOLOAD=1 python -m pytest tests/test_account_ä¼ é€’_ç«¯åˆ°ç«¯.py::TestAccountä¼ é€’ç«¯åˆ°ç«¯::test_account_ä»é…ç½®ä¼ é€’åˆ°ä¸‹å• -v
```

## ğŸ“ å·²éªŒè¯çš„æµ‹è¯•

### Accountä¼ é€’æµ‹è¯•
- âœ… `test_account_ä»é…ç½®ä¼ é€’åˆ°ä¸‹å•` - éªŒè¯accountä»é…ç½®ä¼ é€’åˆ°ä¸‹å•çš„å®Œæ•´æµç¨‹
- âœ… `test_accountä¸ºç©ºæ—¶ä¸‹å•å¤±è´¥` - éªŒè¯accountä¸ºç©ºæ—¶çš„é”™è¯¯å¤„ç†
- âœ… `test_accountä»api_managerè·å–` - éªŒè¯ä»api_managerè·å–account

### Featureæµ‹è¯•
- âœ… `test_buy_silver_account_correct` - Mock APIæ­£å¸¸æµç¨‹
- âœ… `test_buy_silver_account_empty` - accountä¸ºç©ºæ—¶çš„é”™è¯¯å¤„ç†
- âœ… `test_buy_silver_api_error` - APIé”™è¯¯å¤„ç†
- âœ… `test_buy_silver_order_query` - è®¢å•æŸ¥è¯¢åŠŸèƒ½
- âœ… `test_buy_silver_risk_control_failed` - é£æ§å¤±è´¥å¤„ç†

### ç­–ç•¥æµ‹è¯•
- âœ… `test_calculate_indicators` - æŒ‡æ ‡è®¡ç®—
- âœ… `test_check_risk_control` - é£æ§æ£€æŸ¥
- âœ… `test_compute_stop_loss` - æ­¢æŸè®¡ç®—
- âœ… `test_compute_take_profit` - æ­¢ç›ˆè®¡ç®—
- âœ… `test_judge_market_trend` - å¸‚åœºè¶‹åŠ¿åˆ¤æ–­
- âœ… `test_place_tiger_order` - è®¢å•ä¸‹å•

## âš ï¸ å·²çŸ¥é—®é¢˜

### æ”¶é›†é”™è¯¯çš„æµ‹è¯•æ–‡ä»¶

ä»¥ä¸‹æµ‹è¯•æ–‡ä»¶åœ¨æ”¶é›†æ—¶å‡ºç°é”™è¯¯ï¼ˆä¸å½±å“å…¶ä»–æµ‹è¯•ï¼‰ï¼š

1. `tests/test_real_api_paths.py` - æ”¶é›†é”™è¯¯
2. `tests/test_take_profit.py` - æ”¶é›†é”™è¯¯
3. `tests/test_with_quote_client.py` - æ”¶é›†é”™è¯¯

è¿™äº›é”™è¯¯å¯èƒ½æ˜¯ç”±äºï¼š
- æ¨¡å—çº§åˆ«çš„å‰¯ä½œç”¨ä»£ç 
- å¯¼å…¥æ—¶çš„ä¾èµ–é—®é¢˜
- æµ‹è¯•æ–‡ä»¶æœ¬èº«çš„é…ç½®é—®é¢˜

**å»ºè®®**ï¼šè¿™äº›æµ‹è¯•æ–‡ä»¶éœ€è¦å•ç‹¬æ£€æŸ¥å’Œä¿®å¤ã€‚

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [pytestä½¿ç”¨æŒ‡å—.md](./pytestä½¿ç”¨æŒ‡å—.md) - å®Œæ•´çš„ä½¿ç”¨æŒ‡å—
- [pytesté—®é¢˜è§£å†³æ€»ç»“.md](./pytesté—®é¢˜è§£å†³æ€»ç»“.md) - é—®é¢˜åˆ†æå’Œè§£å†³æ–¹æ¡ˆ
- [pytestå’Œcoverageæœ€ç»ˆè§£å†³æ–¹æ¡ˆ.md](./pytestå’Œcoverageæœ€ç»ˆè§£å†³æ–¹æ¡ˆ.md) - æœ€ç»ˆè§£å†³æ–¹æ¡ˆ
- [pytestå¿«é€Ÿå‚è€ƒ.md](./pytestå¿«é€Ÿå‚è€ƒ.md) - å¿«é€Ÿå‚è€ƒæŒ‡å—

## ğŸ”§ å¯ç”¨è„šæœ¬

1. **scripts/run_pytest_tests.sh** - è¿è¡Œpytestæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
2. **scripts/run_tests_with_coverage.sh** - è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
3. **scripts/run_tests_with_coverage_v2.sh** - ä½¿ç”¨coverage runåŒ…è£…pytestï¼ˆæ¨èï¼‰

## ğŸ“ˆ è¦†ç›–ç‡ç»Ÿè®¡

å½“å‰è¦†ç›–ç‡ï¼ˆåŸºäºéƒ¨åˆ†æµ‹è¯•è¿è¡Œï¼‰ï¼š
- `src/api_adapter.py`: 55.75%
- `src/executor/order_executor.py`: 82.03%
- æ€»ä½“è¦†ç›–ç‡: çº¦6.64%ï¼ˆéœ€è¦è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶è·å¾—å‡†ç¡®æ•°æ®ï¼‰

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **ä¿®å¤æ”¶é›†é”™è¯¯çš„æµ‹è¯•æ–‡ä»¶** - æ£€æŸ¥å¹¶ä¿®å¤3ä¸ªæœ‰æ”¶é›†é”™è¯¯çš„æµ‹è¯•æ–‡ä»¶
2. **æé«˜è¦†ç›–ç‡** - è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼Œè¯†åˆ«æœªè¦†ç›–çš„ä»£ç è·¯å¾„
3. **æŒç»­é›†æˆ** - è€ƒè™‘æ·»åŠ CI/CDé…ç½®ï¼Œè‡ªåŠ¨è¿è¡Œæµ‹è¯•
4. **æµ‹è¯•æ–‡æ¡£** - å®Œå–„æµ‹è¯•æ–‡æ¡£ï¼Œè¯´æ˜æ¯ä¸ªæµ‹è¯•çš„ç›®çš„å’Œé¢„æœŸè¡Œä¸º

## âœ… æ€»ç»“

- âœ… pytestæµ‹è¯•æ”¶é›†å’Œè¿è¡Œé—®é¢˜å·²è§£å†³
- âœ… coverageè¦†ç›–ç‡æ”¶é›†å’ŒæŠ¥å‘Šç”Ÿæˆå·²è§£å†³
- âœ… æä¾›äº†å¤šç§ä½¿ç”¨æ–¹æ³•å’Œä¾¿æ·è„šæœ¬
- âœ… åˆ›å»ºäº†å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£
- âœ… å·²éªŒè¯å¤šä¸ªæµ‹è¯•å¯ä»¥æ­£å¸¸è¿è¡Œ

ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨pytestå’Œcoverageè¿›è¡Œæµ‹è¯•å’Œè¦†ç›–ç‡åˆ†æäº†ï¼
