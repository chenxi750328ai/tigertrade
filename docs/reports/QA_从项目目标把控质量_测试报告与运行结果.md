# 从项目目标把控质量：测试报告与运行结果不能「有输出就 OK」

**评审角色**：陈正孤（项目 QA）  
**日期**：2026-02-08  
**结论**：当前测试报告与运行结果**有输出、但未与项目目标形成质量门禁**，存在「报告有数、目标未达、却无显式判定」的风险。必须从**项目目标**出发，对报告和运行结果做**达标判定与闭环**。

---

## 一、项目目标（质量门禁的基准）

以下为 README / 需求分析 / 盈利目标文档中的**明确目标**，应作为「通过/不通过」的基准：

| 目标类型 | 指标 | 目标值 | 来源 |
|----------|------|--------|------|
| **盈利 KPI** | 月盈利率 | 20% | README、需求分析、盈利目标和风险控制 |
| | 夏普比率 | > 2.0 | 需求分析、盈利目标和风险控制 |
| | 最大回撤 | < 10% | 同上 |
| | 胜率 | > 60% | 同上 |
| | 盈亏比 | > 2:1 | 同上 |
| **阶段性** | 第 1 周回测盈利率 | > 15% | README、盈利目标 |
| | 20h 稳定运行 | 不崩溃、错误率 &lt; 1% | 需求 AR6.1、CI_CD 和稳定性测试流程 |

---

## 二、当前报告与运行结果 vs 目标：缺口与问题

### 2.1 算法优化报告（algorithm_optimization_report.md）

**现状**：报告有「实盘收益率」「回测明细」「胜率」等输出，但：

| 问题 | 具体表现 | 与目标关系 |
|------|----------|------------|
| **实盘胜率未做达标判定** | 当前报告显示实盘胜率 **28.57%**，目标 **> 60%**。报告未标注「未达标」或「与目标差距」。 | 读者易误以为「有数字即正常」，无法快速判断质量。 |
| **回测收益未做阶段性目标判定** | 第 1 周目标为回测盈利率 **> 15%**。当前回测：moe/lstm 约 **0.99%**，grid/boll **0 笔 0%**。报告未给出「未达 15%」的结论或建议。 | 无法从报告直接回答「第 1 周目标是否达成」。 |
| **缺少关键 KPI 字段** | 报告中**没有**夏普比率、最大回撤、盈亏比的计算与展示。需求明确要求这三项，报告未产出则无法做目标对照。 | 月盈利率以外的 KPI 无法在报告内验收。 |
| **实际收益率未换算为「月化」并与 20% 对照** | 报告有「实际收益率（老虎核对）+5876.90 USD」，但未换算为月盈利率（%）、未与 20% 目标做对比、未标注达标/未达标。 | 无法从报告判断是否朝向 20% 月盈利率推进。 |
| **无「本报告 KPI 达标情况」小结** | 报告未在头部或尾部增加「相对项目目标的通过/不通过」或「达标/未达标/待改进」的汇总。 | 有输出 ≠ 有质量结论。 |

### 2.2 策略报告与效果数据

- **grid/boll 回测 0 笔 0 收益**：未验证策略有效性，报告未标明「当前无有效回测结论，不可作为策略依据」。
- **回测与实盘逻辑不一致**：已在主 QA 报告 D1 中指出；在此补充：只要逻辑不一致，**回测数字再好看也不能作为实盘达标依据**，报告应显式提示「回测与实盘逻辑不一致，回测仅供参考」。

### 2.3 20h 稳定性运行结果

- **结果未入仓、未与 CI/门禁打通**：`stability_test_20h.py`、`analyze_stability_results.py` 产出 `stability_stats.json`、`stability_analysis.json`、`stability_report.md`，多位于运行目录，**未纳入仓库或固定 artifact**，无法在 MR/发布前做「20h 必须通过」的检查。
- **无明确通过标准**：文档要求「错误率 &lt; 1%」等，但脚本或 CI 中未定义「错误率 &gt; X 则 FAIL」的硬门禁，运行完无统一的是/否结论。
- **有跑即有结果、无跑则无结果**：若未实际跑满 20h，当前流程不会报错或 block，容易形成「以为跑过就 OK」的错觉。

### 2.4 测试运行结果（pytest / 黑盒 / Feature）

- **通过即通过、未与业务目标挂钩**：pytest 全绿、黑盒无禁止项，只说明「流程没报错」，**不说明**「回测盈利率 &gt; 15%」「实盘胜率 &gt; 60%」等是否达成。
- **覆盖率与目标脱节**：覆盖率提升是手段，项目目标是盈利与稳定性；若覆盖率报告未与「必须覆盖的路径」（如订单、风控、20h 路径）绑定，容易出现「覆盖率数字涨了、关键路径未测」的情况。

---

## 三、原则：从项目目标出发的质量门禁

1. **报告/运行结果必须对目标做显式判定**  
   凡项目目标中可量化的指标（月盈利率、夏普、回撤、胜率、盈亏比、回测 &gt; 15%、20h 错误率），在对应报告或运行结果中应：  
   - 要么**产出该指标**并与目标值对比；  
   - 要么**明确标注「本报告未产出该指标」及原因**；  
   - 并给出**达标 / 未达标 / 待改进**的结论，而不是仅列出数字。

2. **「有输出」≠「通过」**  
   报告生成成功、脚本跑完无异常，只表示「有输出」。质量门禁应基于「**输出中的指标是否满足项目目标**」。不满足时应有明确提示或 FAIL，而不是静默通过。

3. **例行与 CI 应对关键指标做自动判定**  
   建议在例行或 CI 中增加（至少）：  
   - 报告生成后，解析报告中的胜率、回测收益率等，与目标比较，**未达标时输出 WARNING 或 FAIL**；  
   - 20h 稳定性运行结束后，将结果写入固定路径/artifact，由 CI 或发布流程读取并判断**是否通过**（如错误率 &lt; 1%、无崩溃）。

---

## 四、建议改进项（按优先级）

### 高优先级

| 编号 | 建议 | 说明 |
|------|------|------|
| **G1** | 算法优化报告增加「KPI 达标情况」小节 | 在报告头部或尾部列出：月盈利率目标 20%、胜率 &gt; 60%、回撤 &lt; 10%、夏普 &gt; 2、盈亏比 &gt; 2:1、第 1 周回测 &gt; 15%；对每项标注「达标/未达标/本报告未产出」，并写清数据来源。 |
| **G2** | 报告产出并对比夏普、回撤、盈亏比 | 若当前数据不足以计算（如需序列数据），在报告中写明「夏普/回撤/盈亏比：未计算，原因：…」；一旦有能力计算，即纳入报告并与目标对比。 |
| **G3** | 实盘胜率、回测收益率做显式达标判定 | 报告中出现实盘胜率、回测 return_pct 时，与目标（胜率 &gt; 60%、回测 &gt; 15%）比较，未达标时明确标「未达标」，并可选地给出改进建议。 |

### 中优先级

| 编号 | 建议 | 说明 |
|------|------|------|
| **G4** | 20h 稳定性结果落盘 + 通过标准 | 将 stability_report 或 summary 写入固定路径（如 `docs/reports/stability_latest.md` 或 CI artifact），并定义「通过」条件（如错误率 &lt; 1%、运行时长 ≥ 20h）；CI 或发布前检查该文件与条件。 |
| **G5** | 例行/CI 中自动检查报告指标 vs 目标 | 报告生成后，用脚本解析报告（或 JSON）中的关键字段，与目标阈值比较，未达标时以非零退出码或 WARNING 形式输出，便于阻断或提醒。 |
| **G6** | 回测与实盘逻辑一致前，报告显式提示 | 在算法报告和策略报告中增加固定说明：「当前 grid/boll 回测与实盘非同一套逻辑，回测结果仅供参考，不可作为实盘达标依据」，直到 D1 修复后再弱化或移除。 |

### 低优先级

| 编号 | 建议 | 说明 |
|------|------|------|
| **G7** | 覆盖率与「必须覆盖路径」绑定 | 在项目质量与自测目标或 CI 中，明确哪些路径为必须覆盖（如订单执行、风控、20h 主循环），覆盖率报告或 CI 不仅报整体比例，也报这些路径是否覆盖。 |
| **G8** | 今日/本月收益率与目标对照 | 状态页或今日收益率展示处，增加「月盈利率目标 20%」「当前月化/日化 X%」的对照，便于一眼判断进度。 |

---

## 五、小结

- **问题本质**：测试报告与运行结果**有输出、有数字**，但未与**项目目标**形成闭环，缺少「达标/未达标」的显式判定与自动门禁。  
- **改进方向**：从项目目标出发，在报告中增加 KPI 达标情况、夏普/回撤/盈亏比（或未产出说明）、实盘与回测的达标判定；在 20h 稳定性与例行/CI 中，将运行结果落盘并定义通过标准，自动判定是否通过。  
- **原则**：**有输出 ≠ OK**；**OK = 输出中的指标满足项目目标，且结论显式、可自动检查**。

---

*陈正孤（QA）| 配套：QA评审报告_Tiger项目_陈正孤.md、QA评审报告_深层次问题与用户验收_陈正孤.md*
