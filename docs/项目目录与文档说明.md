# TigerTrade 项目目录与文档说明

> 本文档说明本仓库下各子目录与主要文档的用途，便于新人或 Agent 快速定位。

---

## 一、根目录

| 文件/目录 | 用途 |
|-----------|------|
| **README.md** | 项目主入口：简介、快速开始、架构、计划、状态页链接等。 |
| **docs/PL.md** | 项目 PL（Project Lead）与发布约定、推送说明。 |
| **AGENT_TASKS.md** | Agent 任务清单与待办，供协作与 RAG 使用。 |
| **Makefile** | 常用命令封装（测试、覆盖率、清理等）。 |
| **requirements.txt** | Python 依赖。 |
| **pytest.ini** | pytest 配置（标记、路径等）。 |
| **.coveragerc** | 覆盖率工具配置。 |

---

## 二、子目录概览

### 1. `config/` — 配置

| 文件 | 用途 |
|------|------|
| **trading.json** | 交易配置：`trading_backend`（如 tiger）、`symbol`（如 SIL.COMEX.202603）、`tick_size`（如 0.005）。环境变量 `TRADING_BACKEND` / `TRADING_SYMBOL` / `TICK_SIZE` 优先。 |
| **trading.json.example** | 交易配置示例，可复制为 `trading.json` 后修改。 |
| **README_trading.md** | 交易配置字段说明与用法。 |
| **strategy_config.json** | 策略与模型配置：默认策略、各策略的 model_path、seq_length 等。 |

---

### 2. `src/` — 核心代码

| 模块/目录 | 用途 |
|-----------|------|
| **tiger1.py** | 主入口：行情、网格/布林/策略逻辑、下单封装（`place_tiger_order`、`place_take_profit_order`）、风控、DEMO 主循环。命令行：`python src/tiger1.py [账户类型] [策略类型]`。 |
| **api_adapter.py** | Tiger Open API 适配：行情、合约、下单等，供 tiger1 与 order_executor 使用。 |
| **config.py** | 数据/标注/训练/特征/**交易**等配置类（含 `TradingConfig`，读 `config/trading.json`）。 |
| **executor/** | 订单与交易执行：`order_executor.py`（实盘下单、tick 取整）、`trading_executor.py`、`data_provider.py`。 |
| **strategies/** | 策略与模型：MoE、Transformer、LSTM、GRU、网格、布林、LLM 等策略实现与工厂。 |
| **data_collector/** | 数据采集：K 线、Tick、实时采集。 |
| **data_processor/** | 数据清洗、归一化、划分。 |
| **trading/** | 交易后端抽象：协议、backend_factory，与具体券商/平台解耦。 |
| **risk/** | 风控：risk_manager 等。 |
| **coordinator/** | 多 Agent 协作：选举、协议、Master 等。 |
| 其他 | `train_*.py` 训练脚本、`prepare_training_data.py`、`optimize_labels.py`、`order_log.py`、`manual_order_mode.py` 等。 |

---

### 3. `scripts/` — 脚本入口

| 类型 | 代表脚本 | 用途 |
|------|----------|------|
| **DEMO/运行** | `run_moe_demo.py`、`run_20h_demo.sh` | 启动 20 小时 DEMO（通过 tiger1 统一入口）。 |
| **例行/收益** | `optimize_algorithm_and_profitability.py` | 收益率分析 + 算法优化（网格/BOLL 回测），写 `docs/today_yield.json`、算法报告。 |
| **例行/报告** | `generate_strategy_reports.py` | 生成策略对比报告与 `docs/reports/` 下 HTML/MD。 |
| **例行/状态** | `update_today_yield_for_status.py` | 为状态页提供今日收益率数据。 |
| **推送** | `push_until_success.sh` | 推送重试直到成功（陈老大例行用）。 |
| **监控** | `cron_routine_monitor.sh`、`run_anomaly_order_check.sh` | 定时监控、异常订单检查。 |
| **数据/训练** | `merge_recent_data_and_train.py`、`启动Tick采集器.sh`、`启动大数据采集.sh` | 数据合并、Tick/大数据采集。 |
| **测试/CI** | `run_pytest_tests.sh`、`run_tests_with_coverage.sh` | 跑测试与覆盖率。 |
| 其他 | 多 Agent 通信、任务监听、Master 运行、分析脚本等。 |

---

### 4. `tests/` — 测试

- 单元测试与集成测试：`test_*.py`。
- 标记 `real_api` 的用例依赖真实 API，CI 默认用 `-m "not real_api"` 排除。
- 覆盖 tiger1、API 适配、订单执行、策略、风控等模块。

---

### 5. `docs/` — 文档

| 类别 | 说明与代表文档 |
|------|----------------|
| **状态与入口** | **status.html**：项目状态页（GitHub Pages 部署）；**PL.md**：PL 与发布；**标的与阶段说明.md**：标的不限于白银、白银为第一阶段测试标的。 |
| **DEMO** | **DEMO运行状态查询指南.md**：如何查进程、日志、异常订单；DEMO 账户/权限、重启记录等。 |
| **例行与效果** | **每日例行_效果数据说明.md**：例行 7 项与效果数据来源；**today_yield.json**：今日收益率（由脚本更新）。 |
| **报告** | **reports/**：策略对比、算法优化报告；**strategy_reports_index.html**：报告索引。 |
| **快速/测试** | **guides/QUICK_START.md**、**guides/TEST_README.md**：快速开始与测试说明。 |
| **readme 类** | **readme/**：CI/CD、多 Agent、并发、监控、Worker、回测等说明。 |
| **策略与设计** | **strategy_designs/**：LSTM、MoE 等策略设计；**时段自适应策略使用说明.md** 等。 |
| **问题与修复** | 大量 MD：修复总结、问题根因、测试报告、训练报告、API 说明等，按标题与日期检索。 |

---

### 6. `shared_rag/` — 共享 RAG 与最佳实践

| 子目录/文件 | 用途 |
|-------------|------|
| **best_practices/** | Agent 必读：**例行工作清单_agent必读.md**（7 项例行）、**陈老大陈老二协作分工**、**状态页刷新规范**、**订单LOG说明**、**手工订单与自动订单关系**、**项目角色与每日例行工作** 等。 |
| **insights/** | 经验与复盘：CI 防回归、DEMO/API 说明、例行日报、漏项回溯等。 |
| **trading_strategy/** | 交易策略参考：时段分析规则、双向交易策略等。 |
| **README.md** | shared_rag 使用说明。 |

---

### 7. 其他目录

| 目录 | 用途 |
|------|------|
| **archive/** | 历史代码与文档：旧测试、旧训练脚本、原始 tiger1、临时报告等，仅作留存。 |
| **examples/** | 示例脚本，演示调用方式或小流程。 |
| **models/**、**models_real/** | 训练产出的模型元数据或结果 JSON（实际权重多在外部如 trading_data）。 |
| **tools/** | 调试、性能、测试小工具：debug、performance、testing 等子目录。 |
| **.github/workflows/** | CI（ci.yml、ci_regression_test.yml）、每日 CI/CD、Pages 部署等。 |

---

## 三、常用入口速查

| 需求 | 入口 |
|------|------|
| 了解项目 | README.md |
| 跑 DEMO | `python scripts/run_moe_demo.py [策略] [时长]` 或 `bash scripts/run_20h_demo.sh` |
| 查 DEMO 状态 | docs/DEMO运行状态查询指南.md、`logs/demo_20h_*.log` |
| 例行 7 项 | shared_rag/best_practices/例行工作清单_agent必读.md、agentfuture 侧陈老大开工必读 |
| 收益率与报告 | `python scripts/optimize_algorithm_and_profitability.py`、`python scripts/generate_strategy_reports.py` |
| 状态页 | docs/status.html、更新后提交并推送 |
| 交易/标的配置 | config/trading.json、config/README_trading.md |
| 测试 | `pytest tests/ -m "not real_api"`、Makefile |

---

*文档维护：随目录与脚本变更更新；若有新增重要目录或文档，可在此补充。*
