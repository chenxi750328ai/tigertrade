# 问题回答

**日期**: 2026-01-29

## 一、这个问题犯了几次了，为什么

### 1.1 历史记录

根据文档搜索，Mock测试和真实API测试混淆的问题在文档中被提及**54次**。

### 1.2 具体次数

从文档记录看，这个问题至少犯了**3次以上**：

1. **第一次**：订单提交问题教训记录（2026-01-29）
   - 问题：Mock测试通过，但真实API测试失败
   - 原因：没有区分Mock测试和真实API测试

2. **第二次**：我的错误承认（2026-01-29）
   - 问题：运行了Mock测试，通过了
   - 原因：没有运行真实API测试

3. **第三次**：今天（2026-01-29）
   - 问题：测试通过了，但DEMO运行失败了
   - 原因：运行了Mock测试，而不是真实API测试

### 1.3 为什么反复犯

1. **没有学习历史教训**：
   - 文档中已经记录了这个问题
   - 但没有查看历史记录
   - 每次都重新犯同样的错误

2. **没有区分测试类型**：
   - Mock测试：验证逻辑
   - 真实API测试：验证API调用
   - 没有明确区分

3. **工作方式问题**：
   - 没有查看历史记录
   - 没有问用户
   - 自己猜测、找理由

## 二、最原始的tiger1.py到哪儿去了，那个初始化测试里就有一个下单测试，代码呢？

### 2.1 文件位置

**当前tiger1.py**: `/home/cx/tigertrade/src/tiger1.py`

**其他版本**:
- `tiger1_v2.py`: V2.0版本（模块化架构）
- `src/tiger1_legacy.py`: 旧版本

### 2.2 下单测试代码

在 `src/tiger1.py` 的 `verify_api_connection()` 函数中（第675-676行）：

```python
#place_tiger_order('BUY', 1, 91.63, 90)
#place_tiger_order('SELL', 1, 91.63, 90)
```

**这些代码被注释掉了！**

### 2.3 为什么被注释

可能的原因：
1. 为了避免在验证API连接时真正下单
2. 测试时不需要真正下单
3. 但这样就失去了测试下单功能的作用

### 2.4 原始代码

原始代码应该是：
```python
place_tiger_order('BUY', 1, 91.63, 90)
place_tiger_order('SELL', 1, 91.63, 90)
```

这样可以测试下单功能是否正常。

## 三、当前运行的到底是哪个py

### 3.1 当前运行的脚本

**进程ID**: 230101  
**运行的脚本**: `python scripts/run_moe_demo.py moe_transformer`

### 3.2 脚本内容

`scripts/run_moe_demo.py`:
- 导入：`from src import tiger1 as t1`
- 使用：`t1.FUTURE_SYMBOL`
- 策略：`moe_transformer`

### 3.3 实际使用的tiger1.py

**实际使用的文件**: `/home/cx/tigertrade/src/tiger1.py`

**验证**:
```python
# scripts/run_moe_demo.py 第71行
from src import tiger1 as t1

# 第137行
data_provider = MarketDataProvider(t1.FUTURE_SYMBOL)
```

所以使用的是 `src/tiger1.py`。

---

**总结**:
1. ❌ 这个问题至少犯了3次以上
2. ❌ 原始tiger1.py的下单测试代码被注释掉了（第675-676行）
3. ✅ 当前运行的是 `scripts/run_moe_demo.py`，使用的是 `src/tiger1.py`
