# DEMO运行状态监控说明

**创建时间**: 2026-01-27  
**状态**: ✅ 监控工具已就绪

---

## 一、监控工具

### 1. 快速状态检查 (`scripts/quick_status.sh`)

快速查看当前运行状态：

```bash
bash scripts/quick_status.sh
```

**显示内容**：
- 进程状态（PID、CPU、内存、运行时间）
- API连接状态
- 策略信息
- 运行时间（已运行、剩余时间）
- 统计信息（预测次数、信号统计、平均置信度）
- 最新预测结果

### 2. 实时监控 (`scripts/monitor_demo_status.py`)

实时监控，每10秒自动更新：

```bash
python scripts/monitor_demo_status.py
```

**功能**：
- 自动刷新显示
- 显示进程状态、API状态、策略信息
- 显示运行时间进度
- 显示统计信息和最新预测结果
- 显示最新日志

**退出**: 按 `Ctrl+C`

### 3. 日志查看

```bash
# 实时查看日志
tail -f /tmp/moe_demo.log

# 查看最新50行
tail -50 /tmp/moe_demo.log

# 查看预测结果
grep -E "(预测|动作|置信度)" /tmp/moe_demo.log | tail -20
```

---

## 二、监控指标

### 进程状态
- **PID**: 进程ID
- **CPU**: CPU使用率
- **内存**: 内存使用率
- **运行时间**: 进程运行时长

### API连接状态
- ✅ **真实API**: 连接到真实DEMO账户
- ⚠️ **Mock模式**: 使用模拟API（异常）

### 策略信息
- **当前策略**: 使用的策略名称（如 moe_transformer）
- **模型路径**: 加载的模型文件
- **序列长度**: 模型使用的序列长度

### 运行时间
- **开始时间**: DEMO启动时间
- **已运行**: 当前已运行时长
- **结束时间**: 预计完成时间
- **剩余时间**: 距离结束的剩余时间

### 统计信息
- **总预测次数**: 累计预测次数
- **买入信号**: 买入信号数量
- **卖出信号**: 卖出信号数量
- **持有信号**: 持有/不操作信号数量
- **平均置信度**: 所有预测的平均置信度
- **错误次数**: 发生的错误数量

### 最新预测结果
- **时间戳**: 预测时间
- **动作**: 买入/卖出/不操作
- **置信度**: 预测置信度 [0, 1]
- **预测收益率**: 预测的收益率（如果模型支持）

---

## 三、使用示例

### 示例1：快速检查状态

```bash
bash scripts/quick_status.sh
```

输出：
```
==========================================
📊 DEMO运行状态快速监控
==========================================

【进程状态】
  PID: 364618 | CPU: 4.9% | 内存: 8.1% | 运行时间: 0:16

【API连接】
  ✅ 真实DEMO账户

【策略信息】
  当前策略: moe_transformer

【运行时间】
  开始时间: 2026-01-27 17:35:32
  已运行: 0小时5分钟27秒
  剩余时间: 19小时54分钟

【统计信息】
  总预测次数: 34
  买入: 34 | 卖出: 0 | 持有: 0
  平均置信度: 0.430
```

### 示例2：实时监控

```bash
python scripts/monitor_demo_status.py
```

会持续刷新显示，每10秒更新一次。

---

## 四、故障排查

### 进程未运行

如果显示"进程未运行"：

```bash
# 检查进程
ps aux | grep "run_moe_demo"

# 检查日志最后几行
tail -20 /tmp/moe_demo.log

# 如果有错误，查看错误信息
grep -E "(错误|Error|Traceback)" /tmp/moe_demo.log | tail -10
```

### API连接问题

如果显示"Mock模式"：

1. 检查API配置文件：`./openapicfg_dem/tiger_openapi_config.properties`
2. 检查网络连接
3. 查看日志中的API初始化信息

### 预测异常

如果预测结果异常（如一直相同）：

1. 检查模型是否正常加载
2. 检查输入数据是否正常
3. 查看日志中的错误信息

---

## 五、监控脚本位置

- **快速状态**: `/home/cx/tigertrade/scripts/quick_status.sh`
- **实时监控**: `/home/cx/tigertrade/scripts/monitor_demo_status.py`
- **日志文件**: `/tmp/moe_demo.log`

---

**最后更新**: 2026-01-27 17:41
