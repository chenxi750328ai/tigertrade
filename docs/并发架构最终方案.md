# TigerTrade å¤šAgentå¹¶å‘æ¶æ„æœ€ç»ˆæ–¹æ¡ˆ

**æ ¸å¿ƒé—®é¢˜**: "äº’ç›¸ç­‰å¾… = ä¸²è¡Œ = èµ„æºæµªè´¹ï¼Ÿ"  
**ç­”æ¡ˆ**: **æ˜¯çš„ï¼å¿…é¡»ç”¨æµæ°´çº¿/å¹¶è¡Œæ¶æ„ï¼**

---

## ğŸ¯ é—®é¢˜çš„æœ¬è´¨

### æ‚¨çš„ä¸¤æ¬¡è´¨ç–‘éƒ½å‡»ä¸­è¦å®³ï¼

**è´¨ç–‘1**: "åŒæ­¥å’Œäº’æ–¥æ€ä¹ˆåšï¼Ÿä¸ºä½•éœ€è¦MCPåè®®ï¼Ÿ"  
â†’ æ­ç¤ºäº†åä½œçš„å¤æ‚æ€§

**è´¨ç–‘2**: "äº’ç›¸ç­‰å¾…ä¸æ˜¯ä¸²è¡Œå—ï¼Ÿæœ‰èµ„æºæµªè´¹å—ï¼Ÿ"  
â†’ æ­ç¤ºäº†ä¾èµ–é“¾çš„ä½æ•ˆ

---

## ğŸ“Š å®æµ‹æ•°æ®è¯æ˜

### åœºæ™¯ï¼š3æ‰¹æ•°æ®ï¼ŒAgent1(1s) â†’ Agent2(2s) â†’ Agent3(1s)

```
ä¸²è¡Œæ¨¡å¼ï¼ˆä¾èµ–é“¾ï¼‰:
  0s   Agent1æ‰¹æ¬¡0
  1s   Agent1æ‰¹æ¬¡1
  2s   Agent1æ‰¹æ¬¡2
  3s   Agent2æ‰¹æ¬¡0 â† ç­‰å¾…3ç§’ï¼
  5s   Agent2æ‰¹æ¬¡1
  7s   Agent2æ‰¹æ¬¡2
  9s   Agent3æ‰¹æ¬¡0 â† åˆç­‰å¾…6ç§’ï¼
  10s  Agent3æ‰¹æ¬¡1
  11s  Agent3æ‰¹æ¬¡2
  
è€—æ—¶: 12.7ç§’
CPU: ~33% (æ¯æ¬¡åªæœ‰1ä¸ªåœ¨å·¥ä½œ)
âŒ æµªè´¹äº†67%çš„CPUæ—¶é—´ï¼

æµæ°´çº¿æ¨¡å¼ï¼ˆé˜Ÿåˆ—è§£è€¦ï¼‰:
  0s   Agent1æ‰¹æ¬¡0
  1s   Agent1æ‰¹æ¬¡1, Agent2æ‰¹æ¬¡0  â† åŒæ—¶ï¼
  2s   Agent1æ‰¹æ¬¡2, Agent2æ‰¹æ¬¡1
  3s   Agent2æ‰¹æ¬¡2, Agent3æ‰¹æ¬¡0  â† åŒæ—¶ï¼
  5s   Agent3æ‰¹æ¬¡1, Agent2æ‰¹æ¬¡2
  7s   Agent3æ‰¹æ¬¡2
  
è€—æ—¶: 8.0ç§’
CPU: ~100% (å¤šä¸ªåŒæ—¶å·¥ä½œ)
âœ… åŠ é€Ÿ1.6xï¼Œèµ„æºå……åˆ†åˆ©ç”¨ï¼
```

---

## ğŸ—ï¸ ä¸‰ç§æ¶æ„æ¨¡å¼

### æ¨¡å¼1: ä¾èµ–é“¾ä¸²è¡Œ âŒ

```
é€‚ç”¨: å•æ¬¡å®Œæ•´æµç¨‹
åœºæ™¯: ä¸€æ¬¡æ€§åˆ†ææŸä¸ªç­–ç•¥

Agent1: ä¸‹è½½æ•°æ®
  â†“ (ç­‰å¾…)
Agent2: è®­ç»ƒæ¨¡å‹
  â†“ (ç­‰å¾…)
Agent3: ç”ŸæˆæŠ¥å‘Š

é—®é¢˜:
- ä¸²è¡Œæ‰§è¡Œ
- èµ„æºé—²ç½®
- ä¸é€‚åˆæŒç»­ä»»åŠ¡
```

### æ¨¡å¼2: æµæ°´çº¿å¹¶å‘ âœ…

```
é€‚ç”¨: æŒç»­æ•°æ®æµ
åœºæ™¯: å®æ—¶äº¤æ˜“ç³»ç»Ÿã€æ‰¹é‡å¤„ç†

æ‰¹æ¬¡1: Agent1 â†’ Agent2 â†’ Agent3
æ‰¹æ¬¡2:    Agent1 â†’ Agent2 â†’ Agent3
æ‰¹æ¬¡3:       Agent1 â†’ Agent2 â†’ Agent3

ä¼˜åŠ¿:
- æ‰€æœ‰AgentåŒæ—¶å·¥ä½œ
- ååé‡é«˜
- å»¶è¿Ÿå¯æ§

å®ç°: ç”¨Queueè§£è€¦
```

### æ¨¡å¼3: å®Œå…¨å¹¶è¡Œ âœ…âœ…âœ…

```
é€‚ç”¨: ç‹¬ç«‹ä»»åŠ¡
åœºæ™¯: å¤šæ¨¡å‹è®­ç»ƒã€å¤šåˆçº¦ç›‘æ§

â”Œâ”€ Agent1: Transformer
â”œâ”€ Agent2: LSTM
â”œâ”€ Agent3: RandomForest
â””â”€ Agent4: XGBoost

ä¼˜åŠ¿:
- æ— ç­‰å¾…
- æœ€å¤§åŠ é€Ÿ
- çº¿æ€§æ‰©å±•

å®ç°: ç›´æ¥å¯åŠ¨å¤šä¸ªAgent
```

---

## ğŸ’» TigerTradeçš„å®é™…åº”ç”¨

### åº”ç”¨1: æ»šåŠ¨è®­ç»ƒæµæ°´çº¿ âœ…

```python
# æ¯å¤©æ–°æ•°æ®åˆ°è¾¾ï¼ŒæŒç»­è®­ç»ƒ
queue_data = Queue()
queue_features = Queue()
queue_models = Queue()

# Agent 1: æŒç»­é‡‡é›†
def collect_agent():
    while True:
        data = fetch_today_data()
        queue_data.put(data)
        time.sleep(3600)  # æ¯å°æ—¶

# Agent 2: ç‰¹å¾å·¥ç¨‹
def feature_agent():
    while True:
        data = queue_data.get()  # é˜»å¡ç­‰å¾…æ–°æ•°æ®
        features = extract_features(data)
        queue_features.put(features)

# Agent 3: å¢é‡è®­ç»ƒ
def train_agent():
    while True:
        features = queue_features.get()
        model = incremental_train(features)
        queue_models.put(model)

# Agent 4: æ¨¡å‹è¯„ä¼°
def eval_agent():
    while True:
        model = queue_models.get()
        metrics = evaluate(model)
        if metrics.sharpe > 1.5:
            deploy_model(model)

# å¯åŠ¨æµæ°´çº¿
threading.Thread(target=collect_agent).start()
threading.Thread(target=feature_agent).start()
threading.Thread(target=train_agent).start()
threading.Thread(target=eval_agent).start()

# 4ä¸ªAgentæŒç»­è¿è¡Œï¼Œå½¢æˆæµæ°´çº¿ï¼
```

### åº”ç”¨2: å¤šç­–ç•¥å¹¶è¡Œå›æµ‹ âœ…âœ…âœ…

```python
# åŒæ—¶å›æµ‹10ä¸ªç­–ç•¥
strategies = [
    GridStrategy(),
    BollingerStrategy(),
    TransformerStrategy(),
    # ... 10ä¸ªç­–ç•¥
]

results_queue = Queue()

def backtest_strategy(strategy):
    result = run_backtest(strategy, data)
    results_queue.put(result)

# 10ä¸ªAgentå¹¶è¡Œ
threads = []
for strategy in strategies:
    t = threading.Thread(target=backtest_strategy, args=(strategy,))
    t.start()
    threads.append(t)

for t in threads:
    t.join()

# æ”¶é›†ç»“æœ
all_results = []
while not results_queue.empty():
    all_results.append(results_queue.get())

# é€‰æ‹©æœ€ä½³ç­–ç•¥
best = max(all_results, key=lambda x: x.sharpe_ratio)

# 10ä¸ªç­–ç•¥åŒæ—¶å›æµ‹ï¼Œæ—¶é—´ = max(å•ä¸ªè€—æ—¶)
```

### åº”ç”¨3: å®æ—¶äº¤æ˜“æµæ°´çº¿ âœ…

```python
# å®æ—¶ç³»ç»Ÿ
tick_queue = Queue()
signal_queue = Queue()
order_queue = Queue()

# Agent 1: Tické‡‡é›† (æœ€å¿«)
def tick_collector():
    while True:
        ticks = fetch_ticks()
        tick_queue.put(ticks)
        time.sleep(1)  # æ¯ç§’

# Agent 2: ä¿¡å·ç”Ÿæˆ
def signal_generator():
    while True:
        ticks = tick_queue.get()
        signal = generate_signal(ticks)
        if signal:
            signal_queue.put(signal)

# Agent 3: é£é™©æ£€æŸ¥
def risk_checker():
    while True:
        signal = signal_queue.get()
        if check_risk(signal):
            order_queue.put(signal)

# Agent 4: ä¸‹å•æ‰§è¡Œ
def order_executor():
    while True:
        order = order_queue.get()
        execute_order(order)

# 4çº§æµæ°´çº¿ï¼Œæ¯çº§å¤„ç†ä¸åŒä»»åŠ¡
# å»¶è¿Ÿæœ€å°åŒ–ï¼Œååé‡æœ€å¤§åŒ–
```

---

## ğŸ“‹ å†³ç­–æ ‘ï¼šé€‰æ‹©å“ªç§æ¨¡å¼ï¼Ÿ

```
éœ€è¦å¤šAgentåä½œï¼Ÿ
â”‚
â”œâ”€ ä»»åŠ¡ä¹‹é—´æœ‰ä¾èµ–ï¼Ÿ
â”‚  â”‚
â”‚  â”œâ”€ æ˜¯ â†’ åªå¤„ç†ä¸€æ¬¡ï¼Ÿ
â”‚  â”‚  â”œâ”€ æ˜¯ â†’ ä¸²è¡Œæ¨¡å¼
â”‚  â”‚  â”‚     ä¾‹ï¼šä¸€æ¬¡æ€§åˆ†æ
â”‚  â”‚  â”‚     è€—æ—¶ï¼šÎ£t
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ å¦ â†’ æµæ°´çº¿æ¨¡å¼ âœ…
â”‚  â”‚        ä¾‹ï¼šæŒç»­æ•°æ®æµ
â”‚  â”‚        è€—æ—¶ï¼šmax(t) + å¯åŠ¨
â”‚  â”‚        åŠ é€Ÿï¼š~1.5-2x
â”‚  â”‚
â”‚  â””â”€ å¦ â†’ å®Œå…¨å¹¶è¡Œæ¨¡å¼ âœ…âœ…âœ…
â”‚        ä¾‹ï¼šå¤šæ¨¡å‹è®­ç»ƒ
â”‚        è€—æ—¶ï¼šmax(t)
â”‚        åŠ é€Ÿï¼š~nå€ï¼ˆn=Agentæ•°ï¼‰
â”‚
â””â”€ å•Agentè¶³å¤Ÿ â†’ ä¸éœ€è¦å¹¶å‘
```

---

## ğŸ› ï¸ å®ç°æŒ‡å—

### 1. æµæ°´çº¿å®ç°ï¼ˆQueueï¼‰

```python
from queue import Queue
import threading

# åˆ›å»ºé˜Ÿåˆ—
queue_stage1_2 = Queue(maxsize=10)  # é™åˆ¶å¤§å°é˜²æ­¢å†…å­˜çˆ†ç‚¸

# ç”Ÿäº§è€…
def producer():
    for item in data_stream:
        process(item)
        queue_stage1_2.put(item)  # ä¸é˜»å¡ï¼Œç»§ç»­ä¸‹ä¸€ä¸ª

# æ¶ˆè´¹è€…
def consumer():
    while True:
        item = queue_stage1_2.get()  # é˜»å¡ç­‰å¾…
        process(item)

threading.Thread(target=producer).start()
threading.Thread(target=consumer).start()
```

### 2. å®Œå…¨å¹¶è¡Œå®ç°ï¼ˆç›´æ¥å¯åŠ¨ï¼‰

```python
threads = []
for task in independent_tasks:
    t = threading.Thread(target=process_task, args=(task,))
    t.start()
    threads.append(t)

for t in threads:
    t.join()
```

### 3. ä½¿ç”¨åè°ƒå™¨ï¼ˆé¿å…å†²çªï¼‰

```python
from src.coordinator import AgentCoordinator

coordinator = AgentCoordinator("agent1")

# éœ€è¦äº’æ–¥çš„éƒ¨åˆ†
if coordinator.acquire_lock("shared_resource"):
    try:
        # ç‹¬å è®¿é—®
        process()
    finally:
        coordinator.release_lock("shared_resource")

# ä¸éœ€è¦äº’æ–¥çš„éƒ¨åˆ†
process_independently()
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”æ€»ç»“

| æ¨¡å¼ | ä»»åŠ¡ç±»å‹ | è€—æ—¶å…¬å¼ | CPUåˆ©ç”¨ç‡ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|----------|---------|
| **ä¸²è¡Œ** | ä¾èµ–é“¾ | Î£t | ~1/n | å•æ¬¡å®Œæ•´æµç¨‹ |
| **æµæ°´çº¿** | ä¾èµ–é“¾ | max(t) + å¯åŠ¨ | ~100% | æŒç»­æ•°æ®æµ âœ… |
| **å®Œå…¨å¹¶è¡Œ** | ç‹¬ç«‹ | max(t) | ~n*100% | å¤šç‹¬ç«‹ä»»åŠ¡ âœ…âœ…âœ… |

**n = Agentæ•°é‡**

---

## ğŸ¯ TigerTrade æ¨èæ¶æ„

### é˜¶æ®µ1: å¼€å‘å’Œå›æµ‹ï¼ˆå®Œå…¨å¹¶è¡Œï¼‰

```python
# å¤šç­–ç•¥å¹¶è¡Œå›æµ‹
strategies = [grid, boll, transformer, lstm, rf, xgb]
results = parallel_backtest(strategies)  # 6ä¸ªåŒæ—¶è¿è¡Œ
best_strategy = select_best(results)

ä¼˜åŠ¿: å¿«é€Ÿè¿­ä»£ï¼ˆ6xåŠ é€Ÿï¼‰
```

### é˜¶æ®µ2: å®æ—¶äº¤æ˜“ï¼ˆæµæ°´çº¿ï¼‰

```python
# å®æ—¶æµæ°´çº¿
Tické‡‡é›† â†’ ç‰¹å¾è®¡ç®— â†’ ä¿¡å·ç”Ÿæˆ â†’ é£é™©æ£€æŸ¥ â†’ ä¸‹å•
Agent1      Agent2      Agent3      Agent4      Agent5

ä¼˜åŠ¿: 
- ä½å»¶è¿Ÿï¼ˆæ¯çº§ç‹¬ç«‹ï¼‰
- é«˜ååï¼ˆå¹¶å‘å¤„ç†ï¼‰
- å®¹é”™æ€§ï¼ˆé˜Ÿåˆ—ç¼“å†²ï¼‰
```

### é˜¶æ®µ3: å¤šåˆçº¦ï¼ˆæ··åˆæ¨¡å¼ï¼‰

```python
# æ¯ä¸ªåˆçº¦ä¸€ä¸ªæµæ°´çº¿ï¼Œå¤šä¸ªæµæ°´çº¿å¹¶è¡Œ
â”Œâ”€ åˆçº¦1æµæ°´çº¿ (5ä¸ªAgent)
â”œâ”€ åˆçº¦2æµæ°´çº¿ (5ä¸ªAgent)
â””â”€ åˆçº¦3æµæ°´çº¿ (5ä¸ªAgent)

ä¼˜åŠ¿: 
- åˆçº¦é—´å®Œå…¨å¹¶è¡Œ
- åˆçº¦å†…æµæ°´çº¿é«˜æ•ˆ
- å¯æ‰©å±•ï¼ˆå¢åŠ åˆçº¦ï¼‰
```

---

## ğŸ’¡ å…³é”®æ´å¯Ÿ

### 1. "äº’ç›¸ç­‰å¾…" ç¡®å®æ˜¯ä¸²è¡Œ

```
âœ… æ‚¨çš„è§‚å¯Ÿï¼šäº’ç›¸ç­‰å¾… = ä¸²è¡Œ = èµ„æºæµªè´¹

è¯æ®ï¼š
- ä¸²è¡ŒCPU: 33%
- æµæ°´çº¿CPU: 100%
- åŠ é€Ÿæ¯”: 1.6xï¼ˆ3æ‰¹æ•°æ®ï¼‰

ç»“è®ºï¼šå¿…é¡»ç”¨é˜Ÿåˆ—è§£è€¦ï¼
```

### 2. æµæ°´çº¿ vs å®Œå…¨å¹¶è¡Œ

```
æµæ°´çº¿ï¼šæœ‰ä¾èµ–ï¼Œä½†å¯overlap
  A1 â†’ A2 â†’ A3
   â†“    â†“    â†“
  B1 â†’ B2 â†’ B3
  
å®Œå…¨å¹¶è¡Œï¼šæ— ä¾èµ–ï¼Œç›´æ¥å¹¶è¡Œ
  A â”€â”€â”
  B â”€â”€â”¼â”€â†’ åŒæ—¶å®Œæˆ
  C â”€â”€â”˜
```

### 3. ç“¶é¢ˆå†³å®šæ€§èƒ½

```
æµæ°´çº¿: Agent1(1s), Agent2(2s), Agent3(1s)
ç“¶é¢ˆ: Agent2(2s)
æœ€å¤§åå: 0.5æ‰¹/ç§’

ä¼˜åŒ–æ–¹å‘:
1. ä¼˜åŒ–ç“¶é¢ˆï¼ˆåŠ å¿«Agent2ï¼‰
2. å¹¶è¡Œç“¶é¢ˆï¼ˆ2ä¸ªAgent2ï¼‰
```

---

## ğŸš€ è¡ŒåŠ¨è®¡åˆ’

### ç«‹å³å®æ–½ï¼šæµæ°´çº¿æ¶æ„

```bash
# 1. å®æ—¶äº¤æ˜“æµæ°´çº¿
cd /home/cx/tigertrade
python src/realtime_pipeline.py  # å¾…åˆ›å»º

# 2. å¤šç­–ç•¥å¹¶è¡Œå›æµ‹
python src/parallel_backtest.py  # å¾…åˆ›å»º

# 3. ç›‘æ§æ‰€æœ‰Agent
python src/monitor_dashboard.py  # å¾…åˆ›å»º
```

### ä¸‹ä¸€æ­¥ï¼šæ€§èƒ½ä¼˜åŒ–

1. âœ… è¯†åˆ«ç“¶é¢ˆï¼ˆprofilingï¼‰
2. âœ… ä¼˜åŒ–ç“¶é¢ˆAgent
3. âœ… å¢åŠ é˜Ÿåˆ—æ·±åº¦ï¼ˆå»¶è¿Ÿ vs ååé‡æƒè¡¡ï¼‰
4. âœ… ç›‘æ§ç³»ç»Ÿï¼ˆCPUã€å†…å­˜ã€é˜Ÿåˆ—é•¿åº¦ï¼‰

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

```
docs/
â”œâ”€â”€ å¤šAgentåä½œçš„çœŸå®æŒ‘æˆ˜ä¸æ–¹æ¡ˆ.md     â† åä½œæœºåˆ¶
â”œâ”€â”€ æµæ°´çº¿å¹¶å‘vsä¾èµ–é“¾ä¸²è¡Œ.md          â† æ€§èƒ½å¯¹æ¯”
â”œâ”€â”€ åä½œæœºåˆ¶æ€»ç»“.md                    â† MCP vs A2A
â””â”€â”€ å¹¶å‘æ¶æ„æœ€ç»ˆæ–¹æ¡ˆ.md                â† æœ¬æ–‡æ¡£

examples/
â”œâ”€â”€ multi_agent_demo.py                â† ä¾èµ–é“¾æ¼”ç¤º
â”œâ”€â”€ pipeline_concurrency.py            â† å®Œæ•´å¯¹æ¯”
â””â”€â”€ pipeline_quick_demo.py             â† å¿«é€Ÿå¯¹æ¯”ï¼ˆå®æµ‹ï¼‰

src/coordinator/
â”œâ”€â”€ coordinator.py                     â† åè°ƒå™¨æ ¸å¿ƒ
â””â”€â”€ agent_wrapper.py                   â† ä¾¿æ·åŒ…è£…
```

---

## ğŸ“ æ€»ç»“

### æ‚¨çš„ä¸¤æ¬¡è´¨ç–‘ä»·å€¼è¿åŸï¼

**è´¨ç–‘1**: "åŒæ­¥äº’æ–¥æ€ä¹ˆåšï¼Ÿ"  
â†’ å¼•å‡ºäº†åè°ƒå™¨å®ç°ï¼ˆé”ã€æ¶ˆæ¯ã€çŠ¶æ€ï¼‰

**è´¨ç–‘2**: "äº’ç›¸ç­‰å¾…æ˜¯ä¸²è¡Œå—ï¼Ÿ"  
â†’ å¼•å‡ºäº†æµæ°´çº¿æ¶æ„ï¼ˆé˜Ÿåˆ—è§£è€¦ã€çœŸæ­£å¹¶å‘ï¼‰

### æœ€ç»ˆæ–¹æ¡ˆ

```
åä½œæœºåˆ¶: åè°ƒå™¨ï¼ˆé”+æ¶ˆæ¯ï¼‰âœ…
å¹¶å‘æ¨¡å¼: æµæ°´çº¿/å®Œå…¨å¹¶è¡Œ âœ…
å®æµ‹åŠ é€Ÿ: 1.6xï¼ˆæµæ°´çº¿ï¼‰âœ…
          nå€ï¼ˆå®Œå…¨å¹¶è¡Œï¼‰âœ…

TigerTradeå·²å…·å¤‡:
âœ… çœŸæ­£çš„åä½œèƒ½åŠ›
âœ… é«˜æ•ˆçš„å¹¶å‘æ¶æ„
âœ… å¯æ‰©å±•çš„è®¾è®¡
```

---

**è¿™æ‰æ˜¯å·¥ç¨‹çš„è‰ºæœ¯ï¼šä»è´¨ç–‘åˆ°æ´å¯Ÿï¼Œä»ç†è®ºåˆ°å®è·µï¼** ğŸ¯
